
R : Copyright 2006, The R Foundation for Statistical Computing
Version 2.3.1 (2006-06-01)
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Library `sm', version 2.1;  Copyright (C) 1997, 2000, 2005 A.W.Bowman & A.Azzalini
type help(sm) for summary information
KernSmooth 2.22 installed
Copyright M. P. Wand 1997
Loading required package: mvtnorm
Loading required package: misc3d
Loading required package: rgl
ks 1.4.5 (2006)
> invisible(options(echo = TRUE))
> 
> 
> 
> for (ff in system("ls R/*.R", intern=TRUE)) source(ff)
> 
> mu1 <- rep(0,5)
> mu2 <- rep(1,5,5)
> Sigma1 <- 0.16*diag(c(1,2, 1,2,1))
> Sigma2 <- 0.16*diag(5)
> props <- c(1,1)/2
> 
> y <- rmvnorm.mixt(n=1000, mus=rbind(mu1, mu2), Sigmas=rbind(Sigma1, Sigma2), props=props)
> 
> unix.time(H <- Hpi(y[,1:2], nstage=1, binned=FALSE)); print(H)
[1] 21.960  0.022 22.285  0.000  0.000
           [,1]       [,2]
[1,] 0.02826841 0.01179224
[2,] 0.01179224 0.03064479
> unix.time(H <- Hpi(y[,1:2], nstage=1, binned=TRUE)); print(H)
[1] 1.210 0.048 1.276 0.000 0.000
           [,1]       [,2]
[1,] 0.02839001 0.01186875
[2,] 0.01186875 0.03051700
> unix.time(H <- Hpi(y[,1:3], nstage=1, binned=FALSE)); print(H)
[1] 166.239   0.504 167.000   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.03730743 0.01840702 0.02396563
[2,] 0.01840702 0.04440555 0.02486832
[3,] 0.02396563 0.02486832 0.04219168
> unix.time(H <- Hpi(y[,1:3], nstage=1, binned=TRUE)); print(H)
[1] 301.530  11.621 313.466   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.03267236 0.01324833 0.01205961
[2,] 0.01324833 0.03874925 0.01081537
[3,] 0.01205961 0.01081537 0.03228992
> unix.time(H <- Hpi(y[,1:4], nstage=1, binned=FALSE)); print(H)
Psi matrix not positive definite
[1] 681.745   1.653 684.123   0.000   0.000
     [,1] [,2] [,3] [,4]
[1,]   NA   NA   NA   NA
[2,]   NA   NA   NA   NA
[3,]   NA   NA   NA   NA
[4,]   NA   NA   NA   NA
> unix.time(H <- Hpi(y[,1:4], nstage=1, binned=TRUE)); print(H)
[1] 382.057  13.670 396.050   0.000   0.000
           [,1]       [,2]        [,3]        [,4]
[1,] 0.04298673 0.02201369 0.013356264 0.011836631
[2,] 0.02201369 0.05363918 0.018167076 0.017384753
[3,] 0.01335626 0.01816708 0.040616273 0.009880174
[4,] 0.01183663 0.01738475 0.009880174 0.055505204
> 
> unix.time(H <- Hpi(y[,1:2], nstage=2, binned=FALSE)); print(H)
[1] 83.414  0.071 83.580  0.000  0.000
           [,1]       [,2]
[1,] 0.02317885 0.01005093
[2,] 0.01005093 0.02620784
> unix.time(H <- Hpi(y[,1:2], nstage=2, binned=TRUE)); print(H)
[1] 4.755 0.121 4.880 0.000 0.000
           [,1]       [,2]
[1,] 0.02328271 0.01016840
[2,] 0.01016840 0.02607001
> unix.time(H <- Hpi(y[,1:3], nstage=2, binned=FALSE)); print(H)
[1] 250.508   0.596 251.384   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.03237123 0.01656970 0.02231364
[2,] 0.01656970 0.03812010 0.02247204
[3,] 0.02231364 0.02247204 0.04120418
> unix.time(H <- Hpi(y[,1:3], nstage=2, binned=TRUE)); print(H)
[1] 362.459   9.658 372.431   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.02815259 0.01193407 0.01099252
[2,] 0.01193407 0.03354089 0.01017329
[3,] 0.01099252 0.01017329 0.02817894
> unix.time(H <- Hpi(y[,1:4], nstage=2, binned=FALSE)); print(H)
Psi matrix not positive definite
[1] 1008.605    2.201 1011.833    0.000    0.000
     [,1] [,2] [,3] [,4]
[1,]   NA   NA   NA   NA
[2,]   NA   NA   NA   NA
[3,]   NA   NA   NA   NA
[4,]   NA   NA   NA   NA
> unix.time(H <- Hpi(y[,1:4], nstage=2, binned=TRUE)); print(H)
[1] 4573.713  235.724 8737.152    0.000    0.000
           [,1]       [,2]        [,3]        [,4]
[1,] 0.03943973 0.02069042 0.013105909 0.011409246
[2,] 0.02069042 0.05026144 0.017211985 0.016247650
[3,] 0.01310591 0.01721198 0.037347616 0.009742464
[4,] 0.01140925 0.01624765 0.009742464 0.051146810
> 
> unix.time(H <- Hpi.diag(y[,1:2], nstage=1, binned=FALSE)); print(H)
[1] 21.959  0.047 23.597  0.000  0.000
           [,1]       [,2]
[1,] 0.02297949 0.00000000
[2,] 0.00000000 0.02978490
> unix.time(H <- Hpi.diag(y[,1:2], nstage=1, binned=TRUE)); print(H)
[1] 0.957 0.050 1.017 0.000 0.000
           [,1]       [,2]
[1,] 0.02295166 0.00000000
[2,] 0.00000000 0.02992932
> unix.time(H <- Hpi.diag(y[,1:3], nstage=1, pilot="samse", binned=FALSE)); print(H)
[1] 165.985   0.457 168.424   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.02438177 0.00000000 0.00000000
[2,] 0.00000000 0.03220024 0.00000000
[3,] 0.00000000 0.00000000 0.04115061
> unix.time(H <- Hpi.diag(y[,1:3], nstage=1, pilot="samse", binned=TRUE)); print(H)
[1] 404.342  11.719 416.505   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.02604258 0.00000000 0.00000000
[2,] 0.00000000 0.03483156 0.00000000
[3,] 0.00000000 0.00000000 0.02768064
> unix.time(H <- Hpi.diag(y[,1:4], nstage=1, pilot="samse", binned=FALSE)); print(H)
[1] 685.792   2.177 731.674   0.000   0.000
           [,1]       [,2]       [,3]       [,4]
[1,] 0.02997154 0.00000000 0.00000000 0.00000000
[2,] 0.00000000 0.03832776 0.00000000 0.00000000
[3,] 0.00000000 0.00000000 0.03069614 0.00000000
[4,] 0.00000000 0.00000000 0.00000000 0.04044815
> unix.time(H <- Hpi.diag(y[,1:4], nstage=1, pilot="samse", binned=TRUE)); print(H)
[1] 394.787   5.951 415.592   0.000   0.000
           [,1]       [,2]       [,3]       [,4]
[1,] 0.03218233 0.00000000 0.00000000 0.00000000
[2,] 0.00000000 0.04752043 0.00000000 0.00000000
[3,] 0.00000000 0.00000000 0.03296776 0.00000000
[4,] 0.00000000 0.00000000 0.00000000 0.04309702
> 
> unix.time(H <- Hpi.diag(y[,1:2], nstage=2, binned=FALSE)); print(H)
[1] 83.920  0.090 86.183  0.000  0.000
           [,1]       [,2]
[1,] 0.02075213 0.00000000
[2,] 0.00000000 0.02817226
> unix.time(H <- Hpi.diag(y[,1:2], nstage=2, binned=TRUE)); print(H)
[1] 2.572 0.005 2.667 0.000 0.000
           [,1]       [,2]
[1,] 0.02071577 0.00000000
[2,] 0.00000000 0.02842847
> unix.time(H <- Hpi.diag(y[,1:3], nstage=2, pilot="samse", binned=FALSE)); print(H)
[1] 255.096   0.600 264.166   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.02292770 0.00000000 0.00000000
[2,] 0.00000000 0.02993857 0.00000000
[3,] 0.00000000 0.00000000 0.04155349
> unix.time(H <- Hpi.diag(y[,1:3], nstage=2, pilot="samse", binned=TRUE)); print(H)
[1] 426.972  12.495 462.676   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.02431753 0.00000000 0.00000000
[2,] 0.00000000 0.03201246 0.00000000
[3,] 0.00000000 0.00000000 0.02589432
> unix.time(H <- Hpi.diag(y[,1:4], nstage=2, pilot="samse", binned=FALSE)); print(H)
[1] 1007.289    2.419 1015.449    0.000    0.000
           [,1]       [,2]       [,3]       [,4]
[1,] 0.02745570 0.00000000 0.00000000 0.00000000
[2,] 0.00000000 0.03424355 0.00000000 0.00000000
[3,] 0.00000000 0.00000000 0.02786644 0.00000000
[4,] 0.00000000 0.00000000 0.00000000 0.03654648
> unix.time(H <- Hpi.diag(y[,1:4], nstage=2, pilot="samse", binned=TRUE)); print(H)
[1] 1546.404   79.488 2669.563    0.000    0.000
           [,1]       [,2]       [,3]       [,4]
[1,] 0.03128518 0.00000000 0.00000000 0.00000000
[2,] 0.00000000 0.04594323 0.00000000 0.00000000
[3,] 0.00000000 0.00000000 0.03199581 0.00000000
[4,] 0.00000000 0.00000000 0.00000000 0.04182968
> 
> 
> unix.time(H <- Hscv(y[,1:2], binned=FALSE)); print(H)
[1] 143.034   0.164 144.256   0.000   0.000
            [,1]        [,2]
[1,] 0.029482375 0.008822053
[2,] 0.008822053 0.037227148
> unix.time(H <- Hscv(y[,1:2], binned=TRUE)); print(H)
[1] 61.765  0.201 63.550  0.000  0.000
            [,1]        [,2]
[1,] 0.029510880 0.008834797
[2,] 0.008834797 0.037243031
> unix.time(H <- Hscv(y[,1:3], binned=FALSE)); print(H)
[1] 538.089   1.602 568.173   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.03746195 0.01040845 0.00892248
[2,] 0.01040845 0.05114738 0.01438887
[3,] 0.00892248 0.01438887 0.03909506
> unix.time(H <- Hscv(y[,1:3], binned=TRUE)); print(H)
[1] 1026.191   17.159 1106.903    0.000    0.000
            [,1]       [,2]        [,3]
[1,] 0.036998383 0.01013568 0.008581554
[2,] 0.010135676 0.05072689 0.014145427
[3,] 0.008581554 0.01414543 0.038680128
> unix.time(H <- Hscv(y[,1:4], binned=FALSE)); print(H)
Psi matrix not positive definite
[1] 2048.707    4.939 2189.164    0.000    0.000
Warning message:
Pilot bandwidth matrix is NA - replaced with maximally smoothed in: Hscv(y[, 1:4],
 binned = FALSE) 
           [,1]       [,2]       [,3]       [,4]
[1,] 0.04865808 0.01245301 0.01713364 0.01351786
[2,] 0.01245301 0.05875743 0.01435914 0.01713083
[3,] 0.01713364 0.01435914 0.04640504 0.01520945
[4,] 0.01351786 0.01713083 0.01520945 0.05998732
> unix.time(H <- Hlscv(y[,1:2])); print(H)
[1] 41.425  0.053 41.824  0.000  0.000
             [,1]         [,2]
[1,]  0.022166696 -0.003324787
[2,] -0.003324787  0.032654190
> unix.time(H <- Hlscv(y[,1:3])); print(H)
[1] 304.003   0.456 319.364   0.000   0.000
              [,1]         [,2]         [,3]
[1,]  0.0241281347 -0.007433583 0.0003292988
[2,] -0.0074335834  0.046486869 0.0045588951
[3,]  0.0003292988  0.004558895 0.0218426010
> unix.time(H <- Hlscv(y[,1:4])); print(H)
[1] 372.279   0.517 380.236   0.000   0.000
             [,1]         [,2]        [,3]         [,4]
[1,]  0.032715320  0.003601412 0.014572687 -0.009526037
[2,]  0.003601412  0.043273656 0.007969034 -0.002069230
[3,]  0.014572687  0.007969034 0.031903370  0.011741567
[4,] -0.009526037 -0.002069230 0.011741567  0.046244170
> 
> 
> unix.time(H <- Hlscv.diag(y[,1:2], binned=FALSE)); print(H)
[1] 20.787  0.020 20.923  0.000  0.000
           [,1]       [,2]
[1,] 0.02289309 0.00000000
[2,] 0.00000000 0.03230151
> unix.time(H <- Hlscv.diag(y[,1:2], binned=TRUE)); print(H)
[1] 28.290  1.143 37.048  0.000  0.000
           [,1]       [,2]
[1,] 0.02323315 0.00000000
[2,] 0.00000000 0.03295444
> unix.time(H <- Hlscv.diag(y[,1:3], binned=FALSE)); print(H)
[1] 45.863  0.158 53.223  0.000  0.000
           [,1]       [,2]       [,3]
[1,] 0.02363785 0.00000000 0.00000000
[2,] 0.00000000 0.04673555 0.00000000
[3,] 0.00000000 0.00000000 0.02172188
> unix.time(H <- Hlscv.diag(y[,1:3], binned=TRUE)); print(H)
[1] 265.253  12.791 379.074   0.000   0.000
           [,1]       [,2]       [,3]
[1,] 0.03411385 0.00000000 0.00000000
[2,] 0.00000000 0.04963076 0.00000000
[3,] 0.00000000 0.00000000 0.02838473
> unix.time(H <- Hlscv.diag(y[,1:4], binned=FALSE)); print(H)
[1] 101.466   0.253 115.533   0.000   0.000
           [,1]       [,2]       [,3]       [,4]
[1,] 0.03025035 0.00000000 0.00000000 0.00000000
[2,] 0.00000000 0.04691843 0.00000000 0.00000000
[3,] 0.00000000 0.00000000 0.02728716 0.00000000
[4,] 0.00000000 0.00000000 0.00000000 0.04449999
> unix.time(H <- Hlscv.diag(y[,1:4], binned=TRUE)); print(H)
[1] 638.053  27.912 830.865   0.000   0.000
           [,1]       [,2]       [,3]       [,4]
[1,] 0.05526874 0.00000000 0.00000000 0.00000000
[2,] 0.00000000 0.08010508 0.00000000 0.00000000
[3,] 0.00000000 0.00000000 0.04916279 0.00000000
[4,] 0.00000000 0.00000000 0.00000000 0.06775337
> 